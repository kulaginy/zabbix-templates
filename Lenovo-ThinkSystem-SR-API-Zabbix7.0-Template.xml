<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>7.0</version>
    <template_groups>
        <template_group>
            <uuid>3b2953c35b174dd0bffc9288d3b2b796</uuid>
            <name>Серверное оборудование</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>e45d7d3e0efc4fed821273f19054adfa</uuid>
            <template>Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template</template>
            <name>Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template</name>
            <groups>
                <group>
                    <name>Серверное оборудование</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>0d3ad265f99240dba03d74f142744e36</uuid>
                    <name>Redfish Chassis Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.chassis.inventoryraw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/Memory</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>data</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>72767f0ce95a4c55a8cfb16ef0f7662d</uuid>
                    <name>Redfish Fans Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.fan.collection.raw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>fan</tag>
                            <value>data</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>aaf450b769974aa18dc114835a13fd38</uuid>
                    <name>Chassis Bios Version</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.bios.version</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.BiosVersion</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>biosversion</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>83d6d83453bb4f0fa3ce80a9a4f6321e</uuid>
                    <name>Chassis FruPartNumber</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.frupartnumber</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Oem.Lenovo.FruPartNumber</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>frupartnumber</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>cc651f1b3b6e4b5e872b66ca877b4d90</uuid>
                    <name>Chassis Host Name</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.host.name</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.HostName</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>hostname</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d2b0a3f2d0404f2fb3c59bd4d83d7c55</uuid>
                    <name>Chassis Location</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.location</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.PostalAddress.Location</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>location</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f406f81c2f1245c0ab267b35097fcdc3</uuid>
                    <name>Chassis Location Contacts</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationcontacts</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.Contacts.ContactName</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationcontacts</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>10e2dd79097f432a96667b8f512ce6c5</uuid>
                    <name>Chassis Location Name</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationname</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.PostalAddress.Name</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationname</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0f1d08c86a03470eba790c6192594de2</uuid>
                    <name>Chassis Location Rack</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationrack</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.Placement.Rack</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationrack</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>14c9546dd54543d3b98a1d7912b61604</uuid>
                    <name>Chassis Location RackOffset</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationrackoffset</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.Placement.RackOffset</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationrackoffset</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>acaa918e7975406d9361c6789dc0d68b</uuid>
                    <name>Chassis Location Room</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationroom</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.PostalAddress.Room</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationroom</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5a79a4bb2cb44fbeb9272283954b77e0</uuid>
                    <name>Chassis PartNumber</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.partnumber</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.PartNumber</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>partnumber</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d56daf90f0dd42ecb01d180fd30ccbd5</uuid>
                    <name>Chassis SKU</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.sku</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.SKU</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>sku</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2caa1866f3554c84899c15924ee76d32</uuid>
                    <name>Chassis SystemBoardSerialNumber</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.systemboardserialnumber</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Oem.Lenovo.SystemBoardSerialNumber</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>systemboardserialnumber</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>514f63f81a3a4c2d948bf01efe4aa51a</uuid>
                    <name>Server HostName</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.hostname</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.HostName</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>info</tag>
                            <value>statushealth</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0d5c81abe57244eda463c408cf615a75</uuid>
                    <name>Server MemorySummary</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.memorysummary</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <units>GB</units>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.MemorySummary.TotalSystemMemoryGiB</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>memory</tag>
                            <value>memorysummary</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d59a8591785e442d9265e08597030a26</uuid>
                    <name>Server Model</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.model</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Model</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>info</tag>
                            <value>model</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7a49ce49ad4f4db3afd118365e588cd3</uuid>
                    <name>Server PowerState</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.powerstate</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.PowerState</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>info</tag>
                            <value>powerstate</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>58165ea2749443798b567dc0f0a1c153</uuid>
                    <name>Server ProcessorModel</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.processormodel</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.ProcessorSummary.Model</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>info</tag>
                            <value>processormodel</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>101d3b30be41483bb8686e69245b3ccc</uuid>
                    <name>Server SerialNumber</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.serialnumber</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.SerialNumber</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>info</tag>
                            <value>serialnumber</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>72e1aba3fb0f44e48d2f09ada6470ff3</uuid>
                    <name>Server StatusHealth</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.statushealth</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.ProcessorSummary.Status.Health</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>info</tag>
                            <value>statushealth</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f8294c07825f416f82b91158fe22761a</uuid>
                    <name>Server StatusState</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.statusstate</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.ProcessorSummary.Status.State</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>info</tag>
                            <value>statusstate</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>250e119fc3fd4f2cb24bb6a6aa4d13db</uuid>
                    <name>Redfish Memory Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.memory.collection.raw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/Memory</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>memory</tag>
                            <value>data</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a175c1fdeefa4cae9109928794817a37</uuid>
                    <name>Redfish Network Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.network.inventoryraw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/EthernetInterfaces</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>ethernet</tag>
                            <value>data</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>bc99a7df751946f69aa20062304e5a6c</uuid>
                    <name>Redfish PCIe Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.pcie.collection.raw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>pcie</tag>
                            <value>data</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>fb0a3d0d581443f5a768e8970538c8df</uuid>
                    <name>Redfish Power Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.power.collection.raw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>power</tag>
                            <value>data</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>012a3749bd204336b398f661e1b87793</uuid>
                    <name>Redfish Processors Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.proc.collection.raw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/Processors</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>processor</tag>
                            <value>data</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e78b3f306eb74a8b88e2bf69cae563b6</uuid>
                    <name>Redfish RAID Health Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.raid.health</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.StorageControllers[0].Status.Health</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/Storage/{$RAID_NAME}</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>disk</tag>
                            <value>raid</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>d5aec119002c4a69bb1c3f0a778c3f51</uuid>
                            <expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.raid.health)=&quot;Critical&quot;</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.raid.health)=&quot;OK&quot;</recovery_expression>
                            <name>Redfish RAID Health is Critical</name>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>823d3b2900064b9da289ba4d2aab2c7c</uuid>
                    <name>Redfish Storage Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.storage.raid_slot10.raw</key>
                    <delay>5m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/Storage/{$RAID_NAME}</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>disk</tag>
                            <value>data</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>b56ce35fe8894c3fb3fd7a15fe8ca2f3</uuid>
                    <name>Redfish Drives Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.drives.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>6fc2cf2f49744748b51239f6ce47328a</uuid>
                            <name>Drive {#DRIVE.NAME}: Drive Status</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.drivestatus[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Oem.Lenovo.DriveStatus || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>status</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>0afa8beb1ba84fe589fa46b5c801153c</uuid>
                                    <expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.drive.drivestatus[{#DRIVE.NAME}])&lt;&gt;&quot;Online&quot;</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.drive.drivestatus[{#DRIVE.NAME}])=&quot;Online&quot;</recovery_expression>
                                    <name>Drive {#DRIVE.NAME}: Disk status has changed</name>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                    <priority>AVERAGE</priority>
                                    <description>Disk status has changed!</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>trigger_status</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>2da8f2d746f34842b2acb651aa4962b9</uuid>
                                    <expression>nodata(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.drive.drivestatus[{#DRIVE.NAME}],20m)=1</expression>
                                    <name>Drive {#DRIVE.NAME}: No data received for 20 minutes</name>
                                    <priority>AVERAGE</priority>
                                    <description>Не получены данные о статусе диска {#DRIVE.NAME} в течение 20 минут.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>trigger_status</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>c0947cb2d7644089bcb7e58bbdbf35c7</uuid>
                                    <expression>change(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.drive.drivestatus[{#DRIVE.NAME}])&lt;&gt;&quot;Online&quot;</expression>
                                    <name>Drive {#DRIVE.NAME}: Status has changed</name>
                                    <priority>AVERAGE</priority>
                                    <description>Статус диска {#DRIVE.NAME} изменился</description>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>trigger_status</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>18322984ee5e4f7b819e2e9cdec973ba</uuid>
                            <name>Drive {#DRIVE.NAME}: Status Health</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.health[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.Health || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>health</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>ed073b8803b44354bd5eb1d8e21c1c7a</uuid>
                                    <expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.drive.health[{#DRIVE.NAME}])=&quot;Critical&quot;</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.drive.health[{#DRIVE.NAME}])&lt;&gt;&quot;Critical&quot;</recovery_expression>
                                    <name>Drive {#DRIVE.NAME}: Disk health is Critical</name>
                                    <priority>DISASTER</priority>
                                    <description>КРИТИЧНО: Диск {#DRIVE.NAME} находится в состоянии Critical!

Требуется немедленная проверка оборудования!</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>health</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>5eea32ed72b44f7eaa6d37e0e2699b20</uuid>
                                    <expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.drive.health[{#DRIVE.NAME}])=&quot;Warning&quot;</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.drive.health[{#DRIVE.NAME}])&lt;&gt;&quot;Warning&quot;</recovery_expression>
                                    <name>Drive {#DRIVE.NAME}: Disk health is Warning</name>
                                    <priority>HIGH</priority>
                                    <description>КРИТИЧНО: Диск {#DRIVE.NAME} находится в состоянии Warning!

Требуется немедленная проверка оборудования!</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>warning</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3c5d9296a9eb49a88e6cb4e30d851134</uuid>
                            <name>Drive {#DRIVE.NAME}: Interface</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.interface[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Protocol || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>Interface</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>5db62f0296d44b46ad11e4365773304c</uuid>
                            <name>Drive {#DRIVE.NAME}: LifeLeftPercent</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.lifeleftpercent[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PredictedMediaLifeLeftPercent || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>lifeleftpercent</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>cf524edf0d864477b2d64d1fc1e213f9</uuid>
                            <name>Drive {#DRIVE.NAME}: Location</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.location[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PhysicalLocation.Info || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>location</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6b351692ba98409c9e4a58edecdbfdb6</uuid>
                            <name>Drive {#DRIVE.NAME}: Manufacturer</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.manufacturer[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Manufacturer || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>manufacturer</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a68a65b62d09460ea680d72c03550792</uuid>
                            <name>Drive {#DRIVE.NAME}: Model</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.model[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Model || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>model</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d445a7d3a3614375a72ff6d45a9359f4</uuid>
                            <name>Drive {#DRIVE.NAME}: Name</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.name[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Name || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>name</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>7b6effd624064beca3c4e0e1bbbd8913</uuid>
                            <name>Drive {#DRIVE.NAME}: Part Number</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.partnumber[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PartNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>partnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>39c19f81bfa34e4da61aacda665d5073</uuid>
                            <name>Drive {#DRIVE.NAME} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            <delay>5m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <timeout>30s</timeout>
                            <url>https://{HOST.CONN}{#DRIVE.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>833f491249314e158dc25236d101a395</uuid>
                            <name>Drive {#DRIVE.NAME}: Serial Number</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.serialnumber[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.SerialNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>serialnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>5028372d5fdd45019c4de84a01ec51d5</uuid>
                            <name>Drive {#DRIVE.NAME}: Size</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.size[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.CapacityBytes || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>size</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>2b1b110074e54cb8ae9c258f0128dc18</uuid>
                            <name>Drive {#DRIVE.NAME}: SKU</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.sku[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.SKU || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>sku</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0120dd2ce35b439e80741d187c9c6d0b</uuid>
                            <name>Drive {#DRIVE.NAME}: Status State</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.state[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.State || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>state</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1358ac8334254946987e9b1f9d95e25e</uuid>
                            <name>Drive {#DRIVE.NAME}: Temperature</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.temperature[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Oem.Lenovo.Temperature || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>temperature</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>afb0d68c4e8e454c8288cdee18b61507</uuid>
                            <name>Drive {#DRIVE.NAME}: Type</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.type[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MediaType || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>type</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.storage.raid_slot10.raw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);

    if (data.body) {
        data = data.body;
    }
    
    var result = [];

    if (!data.Drives || !Array.isArray(data.Drives)) {
        throw new Error('Drives array not found');
    }

    data.Drives.forEach(function(drive, index) {
        if (!drive['@odata.id']) {
            return;
        }
        
        var url = drive['@odata.id'];

        var urlParts = url.split('/');
        var diskName = urlParts[urlParts.length - 1];
        var diskNumber = diskName.replace('Disk.', '');
        
        result.push({
            &quot;{#DRIVE.URL}&quot;: url,
            &quot;{#DRIVE.NAME}&quot;: diskName,
            &quot;{#DRIVE.NUMBER}&quot;: diskNumber,
            &quot;{#DRIVE.FULLURL}&quot;: &quot;https://{HOST.CONN}&quot; + url
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>e0f8489bfd1f4977a1987407aef60de0</uuid>
                    <name>Redfish Ethernet Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.ethernet.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>f28f4a1a4591447092c9e57858f6773f</uuid>
                            <name>Network NIC {#ETHERNET.ID}: LinkHealth</name>
                            <type>DEPENDENT</type>
                            <key>redfish.ethernet.health[{#ETHERNET.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.Health || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>linkhealth</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>bba438d22d5f43c183b0df64a895dfe9</uuid>
                            <name>Network NIC {#ETHERNET.ID}: MACAddress</name>
                            <type>DEPENDENT</type>
                            <key>redfish.ethernet.mac[{#ETHERNET.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MACAddress || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>mac</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3b7e4b0ff0a34faf8a893f2ebda3179d</uuid>
                            <name>Ethernet {#ETHERNET.ID} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            <delay>5m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <timeout>30s</timeout>
                            <url>https://{HOST.CONN}{#ETHERNET.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a0edbbb28e214ea5b352fe5939c5d6e1</uuid>
                            <name>Network NIC {#ETHERNET.ID}: LinkState</name>
                            <type>DEPENDENT</type>
                            <key>redfish.ethernet.state[{#ETHERNET.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.State || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>linkstate</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>fcfb9514528d4c2fb87abb48377b3e70</uuid>
                            <name>Network NIC {#ETHERNET.ID}: LinkStatus</name>
                            <type>DEPENDENT</type>
                            <key>redfish.ethernet.type[{#ETHERNET.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.LinkStatus || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>linkstatus</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.network.inventoryraw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);
    
    if (data.body) {
        data = data.body;
    }
    
    var result = [];
    if (!data.Members || !Array.isArray(data.Members)) {
        throw new Error('Members array not found');
    }
    
    data.Members.forEach(function(member, index) {
        if (!member['@odata.id']) {
            return;
        }
        
        var url = member['@odata.id'];
        
        if (!url) return;
        
        url = url.replace(/\/$/, '');
        var urlParts = url.split('/').filter(function(part) {
            return part !== '';
        });
        
        var ethernetId = urlParts[urlParts.length - 1];
        
        if (!ethernetId) {
            ethernetId = String(index + 1);
        }
        
        result.push({
            &quot;{#ETHERNET.URL}&quot;: url,
            &quot;{#ETHERNET.ID}&quot;: ethernetId,
            &quot;{#ETHERNET.NAME}&quot;: &quot;Memory Slot &quot; + ethernetId
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>36dd33ac83ad4b658614182b1ca4a5e6</uuid>
                    <name>Redfish Fan Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.fan.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>18a4911a64a5450ea5d92353f3a04eba</uuid>
                            <name>Fan {#FAN.ID} Health</name>
                            <type>DEPENDENT</type>
                            <key>redfish.fan.health[{#FAN.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Fans[{#FAN.ID}].Status.Health || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.fan.raw[{#FAN.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>fan</tag>
                                    <value>health</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>cd65a7ff5cfc41d8ab0b18afae78223e</uuid>
                                    <expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.fan.health[{#FAN.NAME}])&lt;&gt;&quot;OK&quot;</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.fan.health[{#FAN.NAME}])=&quot;OK&quot;</recovery_expression>
                                    <name>Fan {#FAN.ID}: Fan health is bad</name>
                                    <priority>DISASTER</priority>
                                    <description>КРИТИЧНО: Кулаер {#FAN.NAME} находится в плохом состоянии!

Требуется немедленная проверка оборудования!</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>fan</tag>
                                            <value>state</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>777c08b23630410f9b59800f5f0ac99b</uuid>
                            <name>Fan {#FAN.ID} Location</name>
                            <type>DEPENDENT</type>
                            <key>redfish.fan.location[{#FAN.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Fans[{#FAN.ID}].Oem.Lenovo.Location.Info || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.fan.raw[{#FAN.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>fan</tag>
                                    <value>location</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>8491d66b91c744a4878da20a63fb27e6</uuid>
                            <name>Fan {#FAN.ID} Name</name>
                            <type>DEPENDENT</type>
                            <key>redfish.fan.name[{#FAN.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Fans[{#FAN.ID}].Name || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.fan.raw[{#FAN.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>fan</tag>
                                    <value>name</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3b16a10a089a4a3caae2cbf659284b53</uuid>
                            <name>FAN {#FAN.ID} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.fan.raw[{#FAN.ID}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <url>https://{HOST.CONN}{#FAN.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>fan</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>15e840caa4264741b2240d2199becbba</uuid>
                            <name>Fan {#FAN.ID} Reading</name>
                            <type>DEPENDENT</type>
                            <key>redfish.fan.reading[{#FAN.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <units>rpm</units>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Fans[{#FAN.ID}].Reading || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.fan.raw[{#FAN.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>fan</tag>
                                    <value>reading</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>76b3a505590d4e11a5dabd5439dbcb28</uuid>
                            <name>Fan {#FAN.ID} State</name>
                            <type>DEPENDENT</type>
                            <key>redfish.fan.state[{#FAN.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Fans[{#FAN.ID}].Status.State || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.fan.raw[{#FAN.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>fan</tag>
                                    <value>state</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.fan.collection.raw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);
    
    if (data.body) {
        data = data.body;
    }
    
    var result = [];
    if (!data.Links.CooledBy || !Array.isArray(data.Links.CooledBy)) {
        throw new Error('Members array not found');
    }
    
    data.Links.CooledBy.forEach(function(member, index) {
        if (!member['@odata.id']) {
            return;
        }
        
        var url = member['@odata.id'];
        
        if (!url) return;
        
        url = url.replace(/\/$/, '');
        var urlParts = url.split('/').filter(function(part) {
            return part !== '';
        });
        
        var fanId = urlParts[urlParts.length - 1];
        
        result.push({
            &quot;{#FAN.URL}&quot;: url,
            &quot;{#FAN.ID}&quot;: fanId,
            &quot;{#FAN.NAME}&quot;: &quot;Fan &quot; + fanId
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>c881a8715f814eb1a75f3127717bf92c</uuid>
                    <name>Redfish Memory Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.memory.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>e5d71887f4ad4cdca554bf90cd7e7497</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Frequency</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.frequency[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.AllowedSpeedsMHz || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>frequency</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>8b0f2a3ac5b24da1ae70ff8b8074282e</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Health</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.health[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.Health || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>health</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>cbcc5a36b96445bea3e35dd2d6e60968</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Location</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.location[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MemoryLocation.Slot || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>location</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>713f21399d9d455395eeace791e852a3</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Manufacturer</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.manufacturer[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Manufacturer || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>manufacturer</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>da93c2298bb145039fd7c01d2b92b850</uuid>
                            <name>Memory Slot {#MEMORY.ID}: MemoryMedia</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.memorymedia[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MemoryMedia || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>memorymedia</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>99d33d64845048c68a3556dca7c43b84</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Name</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.name[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Name || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>name</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>dca07425854e4083a1a49eff8d9d19f2</uuid>
                            <name>Memory Slot {#MEMORY.ID}: PartNumber</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.partnumber[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PartNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>partnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>2085a5bd49f94f8380210d9b6d77ee69</uuid>
                            <name>Memory {#MEMORY.ID} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            <delay>5m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <timeout>30s</timeout>
                            <url>https://{HOST.CONN}{#MEMORY.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <output_format>JSON</output_format>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e118eae71635446fb45557779532e7b9</uuid>
                            <name>Memory Slot {#MEMORY.ID}: SerialNumber</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.serialnumber[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.SerialNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>serialnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e6086a07447a4464a079c239e1b43b10</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Size</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.size[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <status>DISABLED</status>
                            <discover>NO_DISCOVER</discover>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.CapacityMiB || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>size</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e010e06583f146dc8410b34d1f498dbc</uuid>
                            <name>Memory Slot {#MEMORY.ID}: State</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.state[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.State || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>state</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>43607e0daa504dc6b43b17b8c1c7013f</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Type</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.type[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MemoryDeviceType || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>type</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.memory.collection.raw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);
    
    if (data.body) {
        data = data.body;
    }
    
    var result = [];
    if (!data.Members || !Array.isArray(data.Members)) {
        throw new Error('Members array not found');
    }
    
    data.Members.forEach(function(member, index) {
        if (!member['@odata.id']) {
            return;
        }
        
        var url = member['@odata.id'];
        
        if (!url) return;

        url = url.replace(/\/$/, '');
        var urlParts = url.split('/').filter(function(part) {
            return part !== '';
        });
        
        var memoryId = urlParts[urlParts.length - 1];
        
        result.push({
            &quot;{#MEMORY.URL}&quot;: url,
            &quot;{#MEMORY.ID}&quot;: memoryId,
            &quot;{#MEMORY.NAME}&quot;: &quot;Memory Slot &quot; + memoryId
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>c40411e9fabc48fea1bb5322add838be</uuid>
                    <name>Redfish PCIe Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.pcie.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>d46a989cb0bd4b129e66f891d3f14037</uuid>
                            <name>PCIe {#PCIE.ID} Device Class</name>
                            <type>DEPENDENT</type>
                            <key>redfish.pcie.deviceclass[{#PCIE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.DeviceClass || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.pcie.raw[{#PCIE.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>pcie</tag>
                                    <value>deviceclass</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c7c0190424864bd4acbbcb75f1e9fff0</uuid>
                            <name>PCIe {#PCIE.ID} Name</name>
                            <type>DEPENDENT</type>
                            <key>redfish.pcie.name[{#PCIE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Name || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.pcie.raw[{#PCIE.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>pcie</tag>
                                    <value>name</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a23344e54bcc43c5bd1a2200d1a63747</uuid>
                            <name>PCIe {#PCIE.ID} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.pcie.raw[{#PCIE.ID}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <url>https://{HOST.CONN}{#PCIE.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>pcie</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0cb133e5a1ba4970bcd454bdccf6dabe</uuid>
                            <name>PCIe {#PCIE.ID} Slot ID</name>
                            <type>DEPENDENT</type>
                            <key>redfish.pcie.slotid[{#PCIE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Id || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.pcie.raw[{#PCIE.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>pcie</tag>
                                    <value>slot</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.pcie.collection.raw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);
    
    if (data.body) {
        data = data.body;
    }
    
    var result = [];
    if (!data.PCIeFunctions || !Array.isArray(data.PCIeFunctions)) {
        throw new Error('Members array not found');
    }
    
    data.PCIeFunctions.forEach(function(member, index) {
        if (!member['@odata.id']) {
            return;
        }
        
        var url = member['@odata.id'];
        
        if (!url) return;
        
        url = url.replace(/\/$/, '');
        var urlParts = url.split('/').filter(function(part) {
            return part !== '';
        });

        var pcieId = String(index + 1);

        result.push({
            &quot;{#PCIE.URL}&quot;: url,
            &quot;{#PCIE.ID}&quot;: pcieId,
            &quot;{#PCIE.NAME}&quot;: &quot;PCIe Slot &quot; + pcieId
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>d87821ebeab74f84af7b2d945e5dbf88</uuid>
                    <name>Redfish Power Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.power.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>436e3122327c4c44a7c816de7bb6980a</uuid>
                            <name>Power {#POWER.ID} CPU Consumed Watts</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.cpuconsumedwatts[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <units>W</units>
                            <description>Потребление CPU</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerControl[1].PowerConsumedWatts || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>cpu</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>4bc4268ce3a743feadcaff8e0f47ef78</uuid>
                            <name>Power {#POWER.ID} Efficiency Percent</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.efficiencypercent[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <units>%</units>
                            <description>КПД</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerSupplies[{#POWER.ID}].EfficiencyPercent || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>efficiencypercent</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>f9640fe238e14409a86e6a11096099b4</uuid>
                            <name>Power {#POWER.ID} Fru Part Number</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.frupartnumber[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Код запасной части для замены в сервисе</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerSupplies[{#POWER.ID}].Oem.Lenovo.FruPartNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>frupartnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>7d8c60d5e2eb47689c9d3c0a7dd51a07</uuid>
                            <name>Power {#POWER.ID} Health</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.health[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Состояние контроллера питания</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerControl[{#POWER.ID}].Status.Health || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>health</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>98bb629601d84de0819cc12aadc8faea</uuid>
                                    <expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.power.health[{#POWER.NAME}])&lt;&gt;&quot;OK&quot;</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Lenovo-ThinkSystem-SR-API-Zabbix7.0-Template/redfish.power.health[{#POWER.NAME}])=&quot;OK&quot;</recovery_expression>
                                    <name>Power unit {#POWER.NAME}: Power unit is Critical</name>
                                    <priority>DISASTER</priority>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>power</tag>
                                            <value>health</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6cec6962a065479f92c8aeaad5f5b0fc</uuid>
                            <name>Power {#POWER.ID} Line Input Voltage</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.lineinputvoltage[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <units>V</units>
                            <description>Входное напряжение</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerSupplies[{#POWER.ID}].LineInputVoltage || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>lineinputvoltage</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3f763dfab3cb4150b3ae1161d5f4a573</uuid>
                            <name>Power {#POWER.ID} Location</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.location[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerSupplies[{#POWER.ID}].Oem.Lenovo.Location.Info || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>location</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>21d87ad40b264529b23acb70e6d5c2a6</uuid>
                            <name>Power {#POWER.ID} Manufacturer</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.manufacturer[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerSupplies[{#POWER.ID}].Manufacturer || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>manufacturer</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c85347803c2d4723b2bb2c14257047cc</uuid>
                            <name>Power {#POWER.ID} Memory Consumed Watts</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.memoryconsumedwatts[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <units>W</units>
                            <description>Потребление Memory</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerControl[2].PowerConsumedWatts || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>memory</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>06af4578e40c4d708bdc24c65345acfb</uuid>
                            <name>Power {#POWER.ID} Model</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.model[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerSupplies[{#POWER.ID}].Model || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>model</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1541ba9f5b09494a913bf32e3a93f0d5</uuid>
                            <name>Power {#POWER.ID} Part Number</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.partnumber[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Заводской код детали, используемый в сборке</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerSupplies[{#POWER.ID}].PartNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>partnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>af6e8a017dd1443a9c049a34a4118f6f</uuid>
                            <name>Power {#POWER.ID} Power Capacity Watts</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.powercapacitywatts[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>FLOAT</value_type>
                            <units>W</units>
                            <description>Максимальная мощность блока питания</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerSupplies[{#POWER.ID}].PowerCapacityWatts || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>powercapacitywatts</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e2bdd3eb810147d6b163f6e9867804e7</uuid>
                            <name>Power {#POWER.ID} Power Consumed Watts</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.powerconsumedwatts[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Текущая потребляемая мощность</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerControl[{#POWER.ID}].PowerConsumedWatts || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>powerconsumedwatts</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>37a0827019034ceba3fbf35b57e7062c</uuid>
                            <name>Power {#POWER.ID} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.power.raw[{#POWER.ID}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <url>https://{HOST.CONN}{#POWER.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <output_format>JSON</output_format>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>036cb6f7c0fc4e33ab6b5dca1fe5f387</uuid>
                            <name>Power {#POWER.ID} Serial Number</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.serialnumber[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerSupplies[{#POWER.ID}].SerialNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>serialnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1c9ffea6d8c34a369c2f1b96abf9e8d1</uuid>
                            <name>Power {#POWER.ID} State</name>
                            <type>DEPENDENT</type>
                            <key>redfish.power.state[{#POWER.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Состояние контроллера питания</description>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PowerControl[{#POWER.ID}].Status.State || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.power.raw[{#POWER.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>power</tag>
                                    <value>state</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.power.collection.raw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);
    
    if (data.body) {
        data = data.body;
    }
    
    var result = [];
    if (!data.Links.PoweredBy || !Array.isArray(data.Links.PoweredBy)) {
        throw new Error('Members array not found');
    }
    
    data.Links.PoweredBy.forEach(function(member, index) {
        if (!member['@odata.id']) {
            return;
        }
        
        var url = member['@odata.id'];
        
        if (!url) return;
        
        url = url.replace(/\/$/, '');
        var urlParts = url.split('/').filter(function(part) {
            return part !== '';
        });

        var powerId = urlParts[urlParts.length - 1];
        var BPpowerId = Number(powerId) + 1;

        result.push({
            &quot;{#POWER.URL}&quot;: url,
            &quot;{#POWER.ID}&quot;: powerId,
            &quot;{#POWER.BP.ID}&quot;: BPpowerId,
            &quot;{#POWER.NAME}&quot;: &quot;Power unit &quot; + powerId
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>285fd43fc70a4e10b3c20874e87bc03f</uuid>
                    <name>Redfish Processor Collection Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.procs.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>77a91ef390324d4483aeedc5a1540379</uuid>
                            <name>Processor {#PROCESSOR.ID} Architecture</name>
                            <type>DEPENDENT</type>
                            <key>redfish.proc.architecture[{#PROCESSOR.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.ProcessorArchitecture || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.processor.raw[{#PROCESSOR.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>processor</tag>
                                    <value>architecture</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e06c68deef68418abebc4477f768b482</uuid>
                            <name>Processor {#PROCESSOR.ID} Manufacturer</name>
                            <type>DEPENDENT</type>
                            <key>redfish.proc.manufacturer[{#PROCESSOR.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Manufacturer || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.processor.raw[{#PROCESSOR.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>processor</tag>
                                    <value>manufacturer</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>51904c9381e9410e96da994f4701349f</uuid>
                            <name>Processor {#PROCESSOR.ID} MaxSpeedMHz</name>
                            <type>DEPENDENT</type>
                            <key>redfish.proc.maxspeed[{#PROCESSOR.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MaxSpeedMHz || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.processor.raw[{#PROCESSOR.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>processor</tag>
                                    <value>maxspeedmhz</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>2fe94d8bcbe64287a139e5ade1ea3f45</uuid>
                            <name>Processor {#PROCESSOR.ID} Model</name>
                            <type>DEPENDENT</type>
                            <key>redfish.proc.model[{#PROCESSOR.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Model || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.processor.raw[{#PROCESSOR.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>processor</tag>
                                    <value>model</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0d8a9259ecc24940b965f32094033c34</uuid>
                            <name>Processor {#PROCESSOR.ID} Socket</name>
                            <type>DEPENDENT</type>
                            <key>redfish.proc.socket[{#PROCESSOR.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Socket || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.processor.raw[{#PROCESSOR.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>processor</tag>
                                    <value>socket</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6a8b4a2fdbba4262b33f74d703bce98f</uuid>
                            <name>Processor {#PROCESSOR.ID} TotalCores</name>
                            <type>DEPENDENT</type>
                            <key>redfish.proc.totalcores[{#PROCESSOR.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.TotalCores || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.processor.raw[{#PROCESSOR.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>processor</tag>
                                    <value>cores</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1acc398b7377452c917418833d7eb4e3</uuid>
                            <name>Processor {#PROCESSOR.ID} TotalThreads</name>
                            <type>DEPENDENT</type>
                            <key>redfish.proc.totalthreads[{#PROCESSOR.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.TotalThreads || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.processor.raw[{#PROCESSOR.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>processor</tag>
                                    <value>threads</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a6f8f60db062407195f29425abb66199</uuid>
                            <name>Processor {#PROCESSOR.ID} Version</name>
                            <type>DEPENDENT</type>
                            <key>redfish.proc.version[{#PROCESSOR.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Version || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.processor.raw[{#PROCESSOR.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>processor</tag>
                                    <value>version</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>31b7a8920e314a5c8f978a425be32124</uuid>
                            <name>Processor {#PROCESSOR.ID} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.processor.raw[{#PROCESSOR.ID}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <url>https://{HOST.CONN}{#PROCESSOR.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <output_format>JSON</output_format>
                            <tags>
                                <tag>
                                    <tag>processor</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.proc.collection.raw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);
    
    if (data.body) {
        data = data.body;
    }
    
    var result = [];
    if (!data.Members || !Array.isArray(data.Members)) {
        throw new Error('Members array not found');
    }
    
    data.Members.forEach(function(member, index) {
        if (!member['@odata.id']) {
            return;
        }
        
        var url = member['@odata.id'];
        
        if (!url) return;

        url = url.replace(/\/$/, '');
        var urlParts = url.split('/').filter(function(part) {
            return part !== '';
        });
        
        var procId = urlParts[urlParts.length - 1];
        
        result.push({
            &quot;{#PROCESSOR.URL}&quot;: url,
            &quot;{#PROCESSOR.ID}&quot;: procId,
            &quot;{#PROCESSOR.NAME}&quot;: &quot;Processor Number&quot; + procId
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$API_PASSWORD}</macro>
                    <value>password</value>
                </macro>
                <macro>
                    <macro>{$API_USER}</macro>
                    <value>username</value>
                </macro>
                <macro>
                    <macro>{$RAID_NAME}</macro>
                    <value>RAID_Slot1</value>
                </macro>
            </macros>
        </template>
    </templates>
</zabbix_export>
