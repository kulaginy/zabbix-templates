<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>7.0</version>
    <template_groups>
        <template_group>
            <uuid>3b2953c35b174dd0bffc9288d3b2b796</uuid>
            <name>Серверное оборудование</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>fbc622b5f3384d6a9097acd7d5f7d149</uuid>
            <template>Lenovo ThinkSystem SR850 API</template>
            <name>Lenovo ThinkSystem SR850 API</name>
            <groups>
                <group>
                    <name>Серверное оборудование</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>cb76d03e8331492c9841d88562ffac0e</uuid>
                    <name>Redfish Chassis Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.chassis.inventoryraw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/Memory</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                </item>
                <item>
                    <uuid>acbe8a5b611744a7aa6286c20923b9e5</uuid>
                    <name>Chassis FruPartNumber</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.frupartnumber</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Oem.Lenovo.FruPartNumber</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>frupartnumber</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6da69f344ec74c4c966f149ef2fd8c92</uuid>
                    <name>Chassis Location</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.location</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.PostalAddress.Location</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>location</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5b507fef18d643a7b2abd16104621866</uuid>
                    <name>Chassis Location Contacts</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationcontacts</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.Contacts.ContactName</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationcontacts</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>75ce26dcf7bb475891ad9b61387f5e52</uuid>
                    <name>Chassis Location Name</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationname</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.PostalAddress.Name</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationname</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4452548a84594b8b94b083ab4c4b82f9</uuid>
                    <name>Chassis Location Rack</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationrack</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.Placement.Rack</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationrack</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>09101da74e3e463c96e777cb76e749fc</uuid>
                    <name>Chassis Location RackOffset</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationrackoffset</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.Placement.RackOffset</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationrackoffset</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a00de5d7cc1c423b83ddba3208971e72</uuid>
                    <name>Chassis Location Room</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.locationroom</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Location.PostalAddress.Room</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>locationroom</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3e135aafdb1e49bda9b0e729a334bd32</uuid>
                    <name>Chassis PartNumber</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.partnumber</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.PartNumber</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>partnumber</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>320f7634476f473f8d5ce7852bbecd04</uuid>
                    <name>Chassis SKU</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.sku</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.SKU</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>sku</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>60019b364d32404395c5d9f9b1442a74</uuid>
                    <name>Chassis SystemBoardSerialNumber</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.chassis.systemboardserialnumber</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Oem.Lenovo.SystemBoardSerialNumber</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Chassis/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>systemboardserialnumber</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7a0c8d5e7466475da9a8fec075c47b7f</uuid>
                    <name>Server HostName</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.hostname</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.HostName</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>cpu</tag>
                            <value>statushealth</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>94db95000ecf463aa1ceda101a39370e</uuid>
                    <name>Server MemorySummary</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.memorysummary</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.MemorySummary.TotalSystemMemoryGiB</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>memory</tag>
                            <value>memorysummary</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>00b2f50921744807acee80bceef0fa30</uuid>
                    <name>Server Model</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.model</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.Model</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>cpu</tag>
                            <value>model</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>40095db5230c4985be6a717d85d2f762</uuid>
                    <name>Server PowerState</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.powerstate</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.PowerState</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>cpu</tag>
                            <value>powerstate</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2fd5f0cf1d2a48fd8adfb7e3817d5b39</uuid>
                    <name>Server ProcessorModel</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.processormodel</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.ProcessorSummary.Model</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>cpu</tag>
                            <value>processormodel</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>48b355f0cf7e42048f1fc30f8411a41f</uuid>
                    <name>Server SerialNumber</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.serialnumber</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.SerialNumber</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>cpu</tag>
                            <value>serialnumber</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>608e6e024a274dd197e5f48bab641ae1</uuid>
                    <name>Server StatusHealth</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.statushealth</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.ProcessorSummary.Status.Health</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>cpu</tag>
                            <value>statushealth</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>af6731b543fd414f91cfcceedb379bfe</uuid>
                    <name>Server StatusState</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.inventory.statusstate</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.ProcessorSummary.Status.State</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>cpu</tag>
                            <value>statusstate</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d2e170de298b45f3b8f21463b826ea6d</uuid>
                    <name>Redfish Memory Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.memory.collection.raw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/Memory</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                </item>
                <item>
                    <uuid>60e9c2fd7a2b497baec141fd32d326bd</uuid>
                    <name>Redfish Network Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.network.inventoryraw</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}redfish/v1/Systems/1/EthernetInterfaces</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                </item>
                <item>
                    <uuid>3b15f0125fa244bb8fe229c5425823ad</uuid>
                    <name>Redfish RAID Health Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.raid.health</key>
                    <delay>5m</delay>
                    <history>3d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.StorageControllers[0].Status.Health</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/Storage/RAID_Slot10</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>chassis</tag>
                            <value>raid</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>a575cf13d6db48098062087cf6a6aa25</uuid>
                            <expression>last(/Lenovo ThinkSystem SR850 API/redfish.raid.health)=&quot;Critical&quot;</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>last(/Lenovo ThinkSystem SR850 API/redfish.raid.health)=&quot;OK&quot;</recovery_expression>
                            <name>Redfish RAID Health is Critical</name>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>bfa2392bebbe45cd8e98b48c74404bef</uuid>
                    <name>Redfish Storage Discovery</name>
                    <type>HTTP_AGENT</type>
                    <key>redfish.storage.raid_slot10.raw</key>
                    <delay>5m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$API_USER}</username>
                    <password>{$API_PASSWORD}</password>
                    <timeout>30s</timeout>
                    <url>https://{HOST.CONN}/redfish/v1/Systems/1/Storage/RAID_Slot10</url>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>4883d9cb5aaa4050837ba8b4b2549248</uuid>
                    <name>Redfish Drives Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.drives.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>a8ee5288c0604547acb41bc26935c300</uuid>
                            <name>Drive {#DRIVE.NAME}: Drive Status</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.drivestatus[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Oem.Lenovo.DriveStatus || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>status</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>5c4618c4f2fe4455b24c2aa566b1bff3</uuid>
                                    <expression>last(/Lenovo ThinkSystem SR850 API/redfish.drive.drivestatus[{#DRIVE.NAME}])&lt;&gt;&quot;Online&quot;</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Lenovo ThinkSystem SR850 API/redfish.drive.drivestatus[{#DRIVE.NAME}])=&quot;Online&quot;</recovery_expression>
                                    <name>Drive {#DRIVE.NAME}: Disk status has changed</name>
                                    <priority>AVERAGE</priority>
                                    <description>Disk status has changed!</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>trigger_status</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>597691d110f845559d637d11912254a2</uuid>
                                    <expression>nodata(/Lenovo ThinkSystem SR850 API/redfish.drive.drivestatus[{#DRIVE.NAME}],20m)=1</expression>
                                    <name>Drive {#DRIVE.NAME}: No data received for 20 minutes</name>
                                    <priority>AVERAGE</priority>
                                    <description>Не получены данные о статусе диска {#DRIVE.NAME} в течение 20 минут.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>trigger_status</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>3e1eb5aa55944b5699271481f5bc68c8</uuid>
                                    <expression>change(/Lenovo ThinkSystem SR850 API/redfish.drive.drivestatus[{#DRIVE.NAME}])&lt;&gt;0</expression>
                                    <name>Drive {#DRIVE.NAME}: Status has changed</name>
                                    <priority>AVERAGE</priority>
                                    <description>Статус диска {#DRIVE.NAME} изменился

Предыдущий статус: {ITEM.LASTVALUE2}
Новый статус: {ITEM.LASTVALUE1}
Время изменения: {EVENT.TIME} {EVENT.DATE}</description>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>trigger_status</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a988d167451a4d0dada5a26918df11f9</uuid>
                            <name>Drive {#DRIVE.NAME}: Status Health</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.health[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.Health || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>health</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>5391ca4fb617467f971165d30d368376</uuid>
                                    <expression>last(/Lenovo ThinkSystem SR850 API/redfish.drive.health[{#DRIVE.NAME}])=&quot;Critical&quot;</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Lenovo ThinkSystem SR850 API/redfish.drive.health[{#DRIVE.NAME}])&lt;&gt;&quot;Critical&quot;</recovery_expression>
                                    <name>Drive {#DRIVE.NAME}: Disk health is Critical</name>
                                    <priority>DISASTER</priority>
                                    <description>КРИТИЧНО: Диск {#DRIVE.NAME} находится в состоянии Critical!

Требуется немедленная проверка оборудования!</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>health</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>c47aa7f2679149ca83cf7faa4bc99a43</uuid>
                                    <expression>last(/Lenovo ThinkSystem SR850 API/redfish.drive.health[{#DRIVE.NAME}])=&quot;Warning&quot;</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Lenovo ThinkSystem SR850 API/redfish.drive.health[{#DRIVE.NAME}])&lt;&gt;&quot;Warning&quot;</recovery_expression>
                                    <name>Drive {#DRIVE.NAME}: Disk health is Warning</name>
                                    <priority>HIGH</priority>
                                    <description>КРИТИЧНО: Диск {#DRIVE.NAME} находится в состоянии Warning!

Требуется немедленная проверка оборудования!</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>disk</tag>
                                            <value>warning</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c7f674247fee41458d0429767e041f6a</uuid>
                            <name>Drive {#DRIVE.NAME}: Interface</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.interface[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Protocol || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>Interface</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9ff4cbcd257f4dce9f8b8f887c3df0b5</uuid>
                            <name>Drive {#DRIVE.NAME}: LifeLeftPercent</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.lifeleftpercent[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PredictedMediaLifeLeftPercent || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>lifeleftpercent</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>bd95d165c4f2476285c84bf4730a1dd3</uuid>
                            <name>Drive {#DRIVE.NAME}: Location</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.location[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PhysicalLocation.Info || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>location</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>22a56e27673d4218a9d8d73c273f5000</uuid>
                            <name>Drive {#DRIVE.NAME}: Manufacturer</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.manufacturer[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Manufacturer || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>manufacturer</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>92921046f6ac450c9790976956fdea9d</uuid>
                            <name>Drive {#DRIVE.NAME}: Model</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.model[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Model || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>model</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9e0b917c973c433aa752e54304b35805</uuid>
                            <name>Drive {#DRIVE.NAME}: Name</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.name[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Name || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>name</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1a28e7bdfeab4860b4b6896428977681</uuid>
                            <name>Drive {#DRIVE.NAME}: Part Number</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.partnumber[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PartNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>partnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6540eb406ac6405e86223072669433c2</uuid>
                            <name>Drive {#DRIVE.NAME} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            <delay>5m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <timeout>30s</timeout>
                            <url>https://{HOST.CONN}{#DRIVE.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>88202bfa64114513aff104511a735e28</uuid>
                            <name>Drive {#DRIVE.NAME}: Serial Number</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.serialnumber[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.SerialNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>serialnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a2c97efbff09445d90a210d367146eb4</uuid>
                            <name>Drive {#DRIVE.NAME}: Size</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.size[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.CapacityBytes || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>size</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>478d45e364724ea19a5f55d265c4eab4</uuid>
                            <name>Drive {#DRIVE.NAME}: SKU</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.sku[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.SKU || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>sku</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>99e4363de2134676932d9e84ec9d6995</uuid>
                            <name>Drive {#DRIVE.NAME}: Status State</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.state[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.State || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>state</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6ab9440471b7419391c5f827c1f0d6ff</uuid>
                            <name>Drive {#DRIVE.NAME}: Temperature</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.temperature[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Oem.Lenovo.Temperature || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>temperature</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>19a756af366a43a69c856e6e524ea710</uuid>
                            <name>Drive {#DRIVE.NAME}: Type</name>
                            <type>DEPENDENT</type>
                            <key>redfish.drive.type[{#DRIVE.NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MediaType || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.drive.raw[{#DRIVE.NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>disk</tag>
                                    <value>type</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.storage.raid_slot10.raw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);

    if (data.body) {
        data = data.body;
    }
    
    var result = [];

    if (!data.Drives || !Array.isArray(data.Drives)) {
        throw new Error('Drives array not found');
    }

    data.Drives.forEach(function(drive, index) {
        if (!drive['@odata.id']) {
            return;
        }
        
        var url = drive['@odata.id'];

        var urlParts = url.split('/');
        var diskName = urlParts[urlParts.length - 1];
        var diskNumber = diskName.replace('Disk.', '');
        
        result.push({
            &quot;{#DRIVE.URL}&quot;: url,
            &quot;{#DRIVE.NAME}&quot;: diskName,
            &quot;{#DRIVE.NUMBER}&quot;: diskNumber,
            &quot;{#DRIVE.FULLURL}&quot;: &quot;https://{HOST.CONN}&quot; + url
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>fc74dbe260a5425a9ac816e859e2dd2d</uuid>
                    <name>Redfish Ethernet Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.ethernet.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>a4eda8f13e3f476f8d28970644c4ff72</uuid>
                            <name>Network NIC {#ETHERNET.ID}: LinkHealth</name>
                            <type>DEPENDENT</type>
                            <key>redfish.ethernet.health[{#ETHERNET.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.Health || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>linkhealth</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>406c380c0d5e41b4ae565c0d45992aac</uuid>
                            <name>Network NIC {#ETHERNET.ID}: MACAddress</name>
                            <type>DEPENDENT</type>
                            <key>redfish.ethernet.mac[{#ETHERNET.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MACAddress || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>mac</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>502e04062407450fae47f2f1083cf3d8</uuid>
                            <name>Ethernet {#ETHERNET.ID} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            <delay>5m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <timeout>30s</timeout>
                            <url>https://{HOST.CONN}{#ETHERNET.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1d163a570aae46d0a2e1e9e2f3fdebbf</uuid>
                            <name>Network NIC {#ETHERNET.ID}: LinkState</name>
                            <type>DEPENDENT</type>
                            <key>redfish.ethernet.state[{#ETHERNET.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.State || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>linkstate</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>490be174ef044281acd4bdf707de5e1b</uuid>
                            <name>Network NIC {#ETHERNET.ID}: LinkStatus</name>
                            <type>DEPENDENT</type>
                            <key>redfish.ethernet.type[{#ETHERNET.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.LinkStatus || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.ethernet.raw[{#ETHERNET.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>ethernet</tag>
                                    <value>linkstatus</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.network.inventoryraw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);
    
    if (data.body) {
        data = data.body;
    }
    
    var result = [];
    if (!data.Members || !Array.isArray(data.Members)) {
        throw new Error('Members array not found');
    }
    
    data.Members.forEach(function(member, index) {
        if (!member['@odata.id']) {
            return; // Пропускаем элементы без URL
        }
        
        var url = member['@odata.id'];
        
        if (!url) return; // Пропускаем пустые URL
        
        // Удаляем завершающий слеш и разбиваем
        url = url.replace(/\/$/, '');
        var urlParts = url.split('/').filter(function(part) {
            return part !== ''; // Убираем пустые элементы
        });
        
        var ethernetId = urlParts[urlParts.length - 1];
        
        // Если ID всё равно пустой, используем индекс
        if (!ethernetId) {
            ethernetId = String(index + 1);
        }
        
        result.push({
            &quot;{#ETHERNET.URL}&quot;: url,
            &quot;{#ETHERNET.ID}&quot;: ethernetId,
            &quot;{#ETHERNET.NAME}&quot;: &quot;Memory Slot &quot; + ethernetId
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    // Для отладки можно вернуть ошибку
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>925dd5e4e6ea45c8ac0d65f684baed06</uuid>
                    <name>Redfish Memory Discovery</name>
                    <type>DEPENDENT</type>
                    <key>redfish.memory.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>435bc0da1aea4834b311f6f0c9ebe4e8</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Frequency</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.frequency[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.AllowedSpeedsMHz || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>frequency</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>2de2686aae1e4571a3cc31973fefbdb5</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Health</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.health[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.Health || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>health</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6fb0a1749b494a8e9a3f17d505d338d8</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Location</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.location[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MemoryLocation.Slot || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>location</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c2caea16f94a43f88cc57c858ece7ef8</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Manufacturer</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.manufacturer[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Manufacturer || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>manufacturer</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c37050689a4d444da6892b5fdcd436e4</uuid>
                            <name>Memory Slot {#MEMORY.ID}: MemoryMedia</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.memorymedia[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MemoryMedia || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>memorymedia</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>55fa533cc1a54576be1c668e4a9fabec</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Name</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.name[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Name || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>name</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>427b1cf1a3994fffad9e5ee4e92137cc</uuid>
                            <name>Memory Slot {#MEMORY.ID}: PartNumber</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.partnumber[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.PartNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>partnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>8a312fe85bc74673849f8fcee1f13748</uuid>
                            <name>Memory {#MEMORY.ID} Raw Data</name>
                            <type>HTTP_AGENT</type>
                            <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            <delay>5m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <authtype>BASIC</authtype>
                            <username>{$API_USER}</username>
                            <password>{$API_PASSWORD}</password>
                            <timeout>30s</timeout>
                            <url>https://{HOST.CONN}{#MEMORY.URL}</url>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <output_format>JSON</output_format>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>data</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>eec68adbbb564d39aca402ee641694ed</uuid>
                            <name>Memory Slot {#MEMORY.ID}: SerialNumber</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.serialnumber[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.SerialNumber || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>serialnumber</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3dc6e02d1f054ece876d6787826f8e10</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Size</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.size[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.CapacityMiB || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>size</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>38af6071dfe04bbaaa94b8c1c3ef5033</uuid>
                            <name>Memory Slot {#MEMORY.ID}: State</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.state[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.Status.State || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>state</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>5bedcd727d244e37b305bf2f2b233350</uuid>
                            <name>Memory Slot {#MEMORY.ID}: Type</name>
                            <type>DEPENDENT</type>
                            <key>redfish.memory.type[{#MEMORY.ID}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>var data = JSON.parse(value);

if (data.body) {
    data = data.body;
}

return data.MemoryDeviceType || &quot;Unknown&quot;;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redfish.memory.raw[{#MEMORY.ID}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>memory</tag>
                                    <value>type</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redfish.memory.collection.raw</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>try {
    var data = JSON.parse(value);
    
    if (data.body) {
        data = data.body;
    }
    
    var result = [];
    if (!data.Members || !Array.isArray(data.Members)) {
        throw new Error('Members array not found');
    }
    
    data.Members.forEach(function(member, index) {
        if (!member['@odata.id']) {
            return;
        }
        
        var url = member['@odata.id'];
        
        if (!url) return;

        url = url.replace(/\/$/, '');
        var urlParts = url.split('/').filter(function(part) {
            return part !== '';
        });
        
        var memoryId = urlParts[urlParts.length - 1];
        
        result.push({
            &quot;{#MEMORY.URL}&quot;: url,
            &quot;{#MEMORY.ID}&quot;: memoryId,
            &quot;{#MEMORY.NAME}&quot;: &quot;Memory Slot &quot; + memoryId
        });
    });
    
    return JSON.stringify(result);
    
} catch (e) {
    return JSON.stringify([]);
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$API_PASSWORD}</macro>
                    <value>password</value>
                </macro>
                <macro>
                    <macro>{$API_USER}</macro>
                    <value>username</value>
                </macro>
            </macros>
        </template>
    </templates>
</zabbix_export>
